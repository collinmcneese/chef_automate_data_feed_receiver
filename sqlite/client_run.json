"{\"id\":\"3eae5e83-2d8f-4d79-9518-43cc57c6d068\",\"node_id\":\"23e1866b-9c83-416e-8bd1-3ce5de8d399e\",\"node_name\":\"client01\",\"organization\":\"a2local\",\"start_time\":{\"seconds\":1627942792},\"end_time\":{\"seconds\":1627942795},\"source\":\"chef_client\",\"status\":\"success\",\"total_resource_count\":48,\"chef_version\":\"17.3.48\",\"uptime_seconds\":27010,\"environment\":\"test\",\"fqdn\":\"ip-172-22-1-53.us-west-2.compute.internal\",\"source_fqdn\":\"ec2-52-37-242-4.us-west-2.compute.amazonaws.com\",\"ipaddress\":\"172.22.1.53\",\"resources\":[{\"type\":\"directory\",\"name\":\"/var/chef/cache/ssh-hardening\",\"id\":\"/var/chef/cache/ssh-hardening\",\"duration\":\"2\",\"cookbook_name\":\"ssh-hardening\",\"cookbook_version\":\"2.9.0\",\"status\":\"up-to-date\",\"recipe_name\":\"server\",\"result\":\"create\",\"error\":{}},{\"type\":\"ohai\",\"name\":\"reload openssh-server\",\"id\":\"reload openssh-server\",\"duration\":\"0\",\"cookbook_name\":\"ssh-hardening\",\"cookbook_version\":\"2.9.0\",\"status\":\"skipped\",\"recipe_name\":\"server\",\"result\":\"nothing\",\"conditional\":\"not_if { action == :nothing }\",\"error\":{}},{\"type\":\"yum_package\",\"name\":\"openssh-server\",\"id\":\"openssh-server\",\"duration\":\"1175\",\"cookbook_name\":\"ssh-hardening\",\"cookbook_version\":\"2.9.0\",\"status\":\"up-to-date\",\"recipe_name\":\"server\",\"result\":\"install\",\"error\":{}},{\"type\":\"bash\",\"name\":\"build own primes for DH\",\"id\":\"build own primes for DH\",\"duration\":\"0\",\"cookbook_name\":\"ssh-hardening\",\"cookbook_version\":\"2.9.0\",\"status\":\"skipped\",\"recipe_name\":\"server\",\"result\":\"run\",\"conditional\":\"only_if { #code block }\",\"error\":{}},{\"type\":\"ruby_block\",\"name\":\"remove small primes from DH moduli\",\"id\":\"remove small primes from DH moduli\",\"duration\":\"18\",\"cookbook_name\":\"ssh-hardening\",\"cookbook_version\":\"2.9.0\",\"status\":\"skipped\",\"recipe_name\":\"server\",\"result\":\"run\",\"conditional\":\"not_if \\\"test $(awk '$5 < 2047 && $5 ~ /^[0-9]+$/ { print $5 }' /etc/ssh/moduli | uniq | wc -c) -eq 0\\\"\",\"error\":{}},{\"type\":\"service\",\"name\":\"sshd\",\"id\":\"sshd\",\"duration\":\"21\",\"cookbook_name\":\"ssh-hardening\",\"cookbook_version\":\"2.9.0\",\"status\":\"up-to-date\",\"recipe_name\":\"server\",\"result\":\"enable\",\"error\":{}},{\"type\":\"service\",\"name\":\"sshd\",\"id\":\"sshd\",\"duration\":\"20\",\"cookbook_name\":\"ssh-hardening\",\"cookbook_version\":\"2.9.0\",\"status\":\"up-to-date\",\"recipe_name\":\"server\",\"result\":\"start\",\"error\":{}},{\"type\":\"directory\",\"name\":\"openssh-server ssh directory /etc/ssh\",\"id\":\"/etc/ssh\",\"duration\":\"3\",\"cookbook_name\":\"ssh-hardening\",\"cookbook_version\":\"2.9.0\",\"status\":\"up-to-date\",\"recipe_name\":\"server\",\"result\":\"create\",\"error\":{}},{\"type\":\"template\",\"name\":\"/etc/ssh/sshd_config\",\"id\":\"/etc/ssh/sshd_config\",\"duration\":\"20\",\"cookbook_name\":\"ssh-hardening\",\"cookbook_version\":\"2.9.0\",\"status\":\"up-to-date\",\"recipe_name\":\"server\",\"result\":\"create\",\"error\":{}},{\"type\":\"execute\",\"name\":\"unlock root account if it is locked\",\"id\":\"sed 's/^root:!/root:*/' /etc/shadow -i\",\"duration\":\"0\",\"cookbook_name\":\"ssh-hardening\",\"cookbook_version\":\"2.9.0\",\"status\":\"skipped\",\"recipe_name\":\"server\",\"result\":\"run\",\"conditional\":\"only_if { #code block }\",\"error\":{}},{\"type\":\"ohai\",\"name\":\"reload openssh-client\",\"id\":\"reload openssh-client\",\"duration\":\"0\",\"cookbook_name\":\"ssh-hardening\",\"cookbook_version\":\"2.9.0\",\"status\":\"skipped\",\"recipe_name\":\"client\",\"result\":\"nothing\",\"conditional\":\"not_if { action == :nothing }\",\"error\":{}},{\"type\":\"yum_package\",\"name\":\"openssh-client\",\"id\":\"openssh-clients\",\"duration\":\"2\",\"cookbook_name\":\"ssh-hardening\",\"cookbook_version\":\"2.9.0\",\"status\":\"up-to-date\",\"recipe_name\":\"client\",\"result\":\"install\",\"error\":{}},{\"type\":\"directory\",\"name\":\"openssh-client ssh directory /etc/ssh\",\"id\":\"/etc/ssh\",\"duration\":\"2\",\"cookbook_name\":\"ssh-hardening\",\"cookbook_version\":\"2.9.0\",\"status\":\"up-to-date\",\"recipe_name\":\"client\",\"result\":\"create\",\"error\":{}},{\"type\":\"template\",\"name\":\"/etc/ssh/ssh_config\",\"id\":\"/etc/ssh/ssh_config\",\"duration\":\"27\",\"cookbook_name\":\"ssh-hardening\",\"cookbook_version\":\"2.9.0\",\"status\":\"up-to-date\",\"recipe_name\":\"client\",\"result\":\"create\",\"error\":{}},{\"type\":\"log\",\"name\":\"Running cookbook logic\",\"id\":\"Running cookbook logic\",\"duration\":\"1\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"recipe_name\":\"default\",\"result\":\"write\",\"error\":{}},{\"type\":\"yum_package\",\"name\":\"git\",\"id\":\"git\",\"duration\":\"2\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"recipe_name\":\"baseline\",\"result\":\"install\",\"error\":{}},{\"type\":\"yum_package\",\"name\":\"wget\",\"id\":\"wget\",\"duration\":\"1\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"recipe_name\":\"baseline\",\"result\":\"install\",\"error\":{}},{\"type\":\"yum_package\",\"name\":\"vim\",\"id\":\"vim\",\"duration\":\"2\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"recipe_name\":\"baseline\",\"result\":\"install\",\"error\":{}},{\"type\":\"systemd_unit\",\"name\":\"chef-client.service\",\"id\":\"chef-client.service\",\"duration\":\"21\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"result\":\"create\",\"error\":{}},{\"type\":\"systemd_unit\",\"name\":\"chef-client.timer\",\"id\":\"chef-client.timer\",\"duration\":\"21\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"result\":\"create\",\"error\":{}},{\"type\":\"systemd_unit\",\"name\":\"chef-client.timer\",\"id\":\"chef-client.timer\",\"duration\":\"19\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"result\":\"enable\",\"error\":{}},{\"type\":\"systemd_unit\",\"name\":\"chef-client.timer\",\"id\":\"chef-client.timer\",\"duration\":\"19\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"result\":\"start\",\"error\":{}},{\"type\":\"chef_client_systemd_timer\",\"name\":\"Run Chef Infra Client as a systemd timer\",\"id\":\"Run Chef Infra Client as a systemd timer\",\"duration\":\"85\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"recipe_name\":\"baseline\",\"result\":\"add\",\"error\":{}},{\"type\":\"directory\",\"name\":\"/var/chef\",\"id\":\"/var/chef\",\"duration\":\"3\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"recipe_name\":\"baseline\",\"result\":\"create\",\"error\":{}},{\"type\":\"inspec_waiver_file_entry\",\"name\":\"sshd-15\",\"id\":\"sshd-15\",\"duration\":\"2\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"recipe_name\":\"baseline\",\"result\":\"add\",\"error\":{}},{\"type\":\"inspec_waiver_file_entry\",\"name\":\"sshd-21\",\"id\":\"sshd-21\",\"duration\":\"1\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"recipe_name\":\"baseline\",\"result\":\"add\",\"error\":{}},{\"type\":\"inspec_waiver_file_entry\",\"name\":\"sshd-50\",\"id\":\"sshd-50\",\"duration\":\"1\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"recipe_name\":\"baseline\",\"result\":\"add\",\"error\":{}},{\"type\":\"file\",\"name\":\"/etc/chef/automate-cert.crt\",\"id\":\"/etc/chef/automate-cert.crt\",\"duration\":\"0\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"skipped\",\"recipe_name\":\"habitat\",\"result\":\"nothing\",\"conditional\":\"not_if { action == :nothing }\",\"error\":{}},{\"type\":\"hab_install\",\"name\":\"default\",\"id\":\"default\",\"duration\":\"0\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"skipped\",\"result\":\"install\",\"conditional\":\"not_if { #code block }\",\"error\":{}},{\"type\":\"hab_package\",\"name\":\"core/hab-sup\",\"id\":\"core/hab-sup\",\"duration\":\"87\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"result\":\"install\",\"error\":{}},{\"type\":\"hab_package\",\"name\":\"core/hab-launcher\",\"id\":\"core/hab-launcher\",\"duration\":\"98\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"result\":\"install\",\"error\":{}},{\"type\":\"directory\",\"name\":\"/hab/sup/default/config\",\"id\":\"/hab/sup/default/config\",\"duration\":\"0\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"skipped\",\"result\":\"create\",\"conditional\":\"only_if { #code block }\",\"error\":{}},{\"type\":\"template\",\"name\":\"/hab/sup/default/config/sup.toml\",\"id\":\"/hab/sup/default/config/sup.toml\",\"duration\":\"0\",\"status\":\"skipped\",\"result\":\"create\",\"conditional\":\"only_if { #code block }\",\"error\":{}},{\"type\":\"systemd_unit\",\"name\":\"hab-sup.service\",\"id\":\"hab-sup.service\",\"duration\":\"21\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"result\":\"create\",\"error\":{}},{\"type\":\"service\",\"name\":\"hab-sup\",\"id\":\"hab-sup\",\"duration\":\"20\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"result\":\"enable\",\"error\":{}},{\"type\":\"service\",\"name\":\"hab-sup\",\"id\":\"hab-sup\",\"duration\":\"21\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"result\":\"start\",\"error\":{}},{\"type\":\"hab_sup_systemd\",\"name\":\"default\",\"id\":\"default\",\"duration\":\"255\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"recipe_name\":\"habitat\",\"result\":\"run\",\"error\":{}},{\"type\":\"hab_package\",\"name\":\"core/node14\",\"id\":\"core/node14\",\"duration\":\"83\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"recipe_name\":\"habitat\",\"result\":\"install\",\"error\":{}},{\"type\":\"hab_package\",\"name\":\"core/mongodb\",\"id\":\"core/mongodb\",\"duration\":\"74\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"recipe_name\":\"habitat\",\"result\":\"install\",\"error\":{}},{\"type\":\"hab_service\",\"name\":\"core/mongodb\",\"id\":\"core/mongodb\",\"duration\":\"11\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"recipe_name\":\"habitat\",\"result\":\"load\",\"error\":{}},{\"type\":\"file\",\"name\":\"/etc/modprobe.d/disable_cramfs.conf\",\"id\":\"/etc/modprobe.d/disable_cramfs.conf\",\"duration\":\"10\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"result\":\"create\",\"error\":{}},{\"type\":\"kernel_module\",\"name\":\"cramfs\",\"id\":\"cramfs\",\"duration\":\"13\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"recipe_name\":\"cis_remediation\",\"result\":\"disable\",\"error\":{}},{\"type\":\"kernel_module\",\"name\":\"cramfs\",\"id\":\"cramfs\",\"duration\":\"0\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"recipe_name\":\"cis_remediation\",\"result\":\"unload\",\"error\":{}},{\"type\":\"execute\",\"name\":\"update initramfs\",\"id\":\"dracut -f\",\"duration\":\"0\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"skipped\",\"result\":\"nothing\",\"conditional\":\"not_if { action == :nothing }\",\"error\":{}},{\"type\":\"file\",\"name\":\"/etc/modprobe.d/disable_hfs.conf\",\"id\":\"/etc/modprobe.d/disable_hfs.conf\",\"duration\":\"17\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"result\":\"create\",\"error\":{}},{\"type\":\"kernel_module\",\"name\":\"hfs\",\"id\":\"hfs\",\"duration\":\"19\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"recipe_name\":\"cis_remediation\",\"result\":\"disable\",\"error\":{}},{\"type\":\"kernel_module\",\"name\":\"hfs\",\"id\":\"hfs\",\"duration\":\"0\",\"cookbook_name\":\"test_cookbook\",\"cookbook_version\":\"0.1.4\",\"status\":\"up-to-date\",\"recipe_name\":\"cis_remediation\",\"result\":\"unload\",\"error\":{}},{\"type\":\"chef_client_secure_key\",\"name\":\"enforce_pass_phrase\",\"id\":\"enforce_pass_phrase\",\"duration\":\"1\",\"cookbook_name\":\"client_credentials_secure\",\"cookbook_version\":\"0.1.0\",\"status\":\"up-to-date\",\"recipe_name\":\"default\",\"result\":\"enforce\",\"error\":{}}],\"run_list\":[\"recipe[ssh-hardening::default]\",\"recipe[test_cookbook::default]\",\"recipe[client_credentials_secure::default]\"],\"deprecations\":[{\"message\":\"The hab_config resource in the habitat cookbook should declare `unified_mode true`\",\"url\":\"https://docs.chef.io/deprecations_unified_mode/\",\"location\":\"/var/chef/cache/cookbooks/habitat/resources/config.rb\"},{\"message\":\"The hab_install resource in the habitat cookbook should declare `unified_mode true`\",\"url\":\"https://docs.chef.io/deprecations_unified_mode/\",\"location\":\"/var/chef/cache/cookbooks/habitat/resources/install.rb\"},{\"message\":\"The hab_service resource in the habitat cookbook should declare `unified_mode true`\",\"url\":\"https://docs.chef.io/deprecations_unified_mode/\",\"location\":\"/var/chef/cache/cookbooks/habitat/resources/service.rb\"},{\"message\":\"The hab_user_toml resource in the habitat cookbook should declare `unified_mode true`\",\"url\":\"https://docs.chef.io/deprecations_unified_mode/\",\"location\":\"/var/chef/cache/cookbooks/habitat/resources/user_toml.rb\"},{\"message\":\"The  resource in the client_credentials_secure cookbook should declare `unified_mode true`\",\"url\":\"https://docs.chef.io/deprecations_unified_mode/\",\"location\":\"/var/chef/cache/cookbooks/client_credentials_secure/resources/chef_client_secure_key_base64.rb\"}],\"error\":{},\"resource_names\":[\"/var/chef/cache/ssh-hardening\",\"reload openssh-server\",\"openssh-server\",\"build own primes for DH\",\"remove small primes from DH moduli\",\"sshd\",\"sshd\",\"openssh-server ssh directory /etc/ssh\",\"/etc/ssh/sshd_config\",\"unlock root account if it is locked\",\"reload openssh-client\",\"openssh-client\",\"openssh-client ssh directory /etc/ssh\",\"/etc/ssh/ssh_config\",\"Running cookbook logic\",\"git\",\"wget\",\"vim\",\"chef-client.service\",\"chef-client.timer\",\"chef-client.timer\",\"chef-client.timer\",\"Run Chef Infra Client as a systemd timer\",\"/var/chef\",\"sshd-15\",\"sshd-21\",\"sshd-50\",\"/etc/chef/automate-cert.crt\",\"default\",\"core/hab-sup\",\"core/hab-launcher\",\"/hab/sup/default/config\",\"/hab/sup/default/config/sup.toml\",\"hab-sup.service\",\"hab-sup\",\"hab-sup\",\"default\",\"core/node14\",\"core/mongodb\",\"core/mongodb\",\"/etc/modprobe.d/disable_cramfs.conf\",\"cramfs\",\"cramfs\",\"update initramfs\",\"/etc/modprobe.d/disable_hfs.conf\",\"hfs\",\"hfs\",\"enforce_pass_phrase\"],\"recipes\":[\"ssh-hardening::default\",\"test_cookbook::default\",\"client_credentials_secure::default\",\"ssh-hardening::server\",\"ssh-hardening::client\",\"test_cookbook::baseline\",\"test_cookbook::habitat\",\"test_cookbook::cis_remediation\"],\"chef_tags\":[\"dev\",\"also_dev\",\"dev:::with_characters-too\"],\"cookbooks\":[\"client_credentials_secure\",\"habitat\",\"ssh-hardening\",\"test_cookbook\",\"audit\"],\"platform\":\"amazon 2\",\"platform_family\":\"amazon\",\"platform_version\":\"2\",\"policy_name\":\"default_policy\",\"policy_group\":\"test\",\"policy_revision\":\"0fedca3dac70dfd5f91a699bfbe30c6ac542a99f3ac0f580432490fc1093969f\",\"expanded_run_list\":{\"id\":\"_policy_node\",\"run_list\":[{\"type\":\"recipe\",\"name\":\"ssh-hardening::default\"},{\"type\":\"recipe\",\"name\":\"test_cookbook::default\"},{\"type\":\"recipe\",\"name\":\"client_credentials_secure::default\"}]},\"versioned_cookbooks\":[{\"name\":\"test_cookbook\",\"version\":\"0.1.4\"},{\"name\":\"audit\",\"version\":\"9.5.0\"},{\"name\":\"client_credentials_secure\",\"version\":\"0.1.0\"},{\"name\":\"habitat\",\"version\":\"2.2.4\"},{\"name\":\"ssh-hardening\",\"version\":\"2.9.0\"}],\"ip6address\":\"fe80::20:9fff:fef8:507b\",\"timezone\":\"UTC\",\"domain\":\"us-west-2.compute.internal\",\"hostname\":\"ip-172-22-1-53\",\"memory_total\":\"8063548kB\",\"macaddress\":\"02:20:9F:F8:50:7B\",\"dmi_system_serial_number\":\"ec24ca6b-a7d5-1996-04cb-a72e78ac2566\",\"dmi_system_manufacturer\":\"Amazon EC2\",\"virtualization_role\":\"guest\",\"virtualization_system\":\"amazonec2\",\"kernel_version\":\"#1 SMP Tue Jul 20 20:35:54 UTC 2021\",\"kernel_release\":\"4.14.238-182.422.amzn2.x86_64\",\"cloud_provider\":\"ec2\"}"
